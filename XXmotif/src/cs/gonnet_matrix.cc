// Copyright 2009, Andreas Biegert

#include "gonnet_matrix.h"
#include "substitution_matrix-inl.h"

namespace {

const float g_gonnet[]={
//  A     R     N     D     C     Q     E     G     H     I     L     K     M     .0f     P     S     T     W     Y     V
 10227.0f, 3430.0f, 2875.0f, 3869.0f, 1625.0f, 2393.0f, 4590.0f, 6500.0f, 2352.0f, 3225.0f, 5819.0f, 4172.0f, 1435.0f, 1579.0f, 3728.0f, 4610.0f, 6264.0f,  418.0f, 1824.0f, 5709.0f, // A
  3430.0f, 7780.0f, 2209.0f, 2589.0f,  584.0f, 2369.0f, 3368.0f, 3080.0f, 2173.0f, 1493.0f, 3093.0f, 5701.0f,  763.0f,  859.0f, 1893.0f, 2287.0f, 3487.0f,  444.0f, 1338.0f, 2356.0f, // R
  2875.0f, 2209.0f, 3868.0f, 3601.0f,  501.0f, 1541.0f, 2956.0f, 3325.0f, 1951.0f, 1065.0f, 2012.0f, 2879.0f,  532.0f,  688.0f, 1480.0f, 2304.0f, 3204.0f,  219.0f, 1148.0f, 1759.0f, // N
  3869.0f, 2589.0f, 3601.0f, 8618.0f,  488.0f, 2172.0f, 6021.0f, 4176.0f, 2184.0f, 1139.0f, 2151.0f, 3616.0f,  595.0f,  670.0f, 2086.0f, 2828.0f, 3843.0f,  204.0f, 1119.0f, 2015.0f, // D
  1625.0f,  584.0f,  501.0f,  488.0f, 5034.0f,  355.0f,  566.0f,  900.0f,  516.0f,  741.0f, 1336.0f,  591.0f,  337.0f,  549.0f,  419.0f,  901.0f, 1197.0f,  187.0f,  664.0f, 1373.0f, // C
  2393.0f, 2369.0f, 1541.0f, 2172.0f,  355.0f, 1987.0f, 2891.0f, 1959.0f, 1587.0f, 1066.0f, 2260.0f, 2751.0f,  570.0f,  628.0f, 1415.0f, 1595.0f, 2323.0f,  219.0f,  871.0f, 1682.0f, // Q
  4590.0f, 3368.0f, 2956.0f, 6021.0f,  566.0f, 2891.0f, 8201.0f, 3758.0f, 2418.0f, 1624.0f, 3140.0f, 4704.0f,  830.0f,  852.0f, 2418.0f, 2923.0f, 4159.0f,  278.0f, 1268.0f, 2809.0f, // E
  6500.0f, 3080.0f, 3325.0f, 4176.0f,  900.0f, 1959.0f, 3758.0f,26066.0f, 2016.0f, 1354.0f, 2741.0f, 3496.0f,  741.0f,  797.0f, 2369.0f, 3863.0f, 4169.0f,  375.0f, 1186.0f, 2569.0f, // G
  2352.0f, 2173.0f, 1951.0f, 2184.0f,  516.0f, 1587.0f, 2418.0f, 2016.0f, 5409.0f, 1123.0f, 2380.0f, 2524.0f,  600.0f, 1259.0f, 1298.0f, 1642.0f, 2446.0f,  383.0f,  876.0f, 1691.0f, // H
  3225.0f, 1493.0f, 1065.0f, 1139.0f,  741.0f, 1066.0f, 1624.0f, 1354.0f, 1123.0f, 6417.0f, 9630.0f, 1858.0f, 1975.0f, 2225.0f, 1260.0f, 1558.0f, 3131.0f,  417.0f, 1697.0f, 7504.0f, // I
  5819.0f, 3093.0f, 2012.0f, 2151.0f, 1336.0f, 2260.0f, 3140.0f, 2741.0f, 2380.0f, 9630.0f,25113.0f, 3677.0f, 4187.0f, 5540.0f, 2670.0f, 2876.0f, 5272.0f, 1063.0f, 3945.0f,11005.0f, // L
  4172.0f, 5701.0f, 2879.0f, 3616.0f,  591.0f, 2751.0f, 4704.0f, 3496.0f, 2524.0f, 1858.0f, 3677.0f, 7430.0f,  949.0f,  975.0f, 2355.0f, 2847.0f, 4340.0f,  333.0f, 1451.0f, 2932.0f, // K
  1435.0f,  763.0f,  532.0f,  595.0f,  337.0f,  570.0f,  830.0f,  741.0f,  600.0f, 1975.0f, 4187.0f,  949.0f, 1300.0f, 1111.0f,  573.0f,  743.0f, 1361.0f,  218.0f,  828.0f, 2310.0f, // M
  1579.0f,  859.0f,  688.0f,  670.0f,  549.0f,  628.0f,  852.0f,  797.0f, 1259.0f, 2225.0f, 5540.0f,  975.0f, 1111.0f, 6126.0f,  661.0f,  856.0f, 1498.0f, 1000.0f, 4464.0f, 2602.0f, // .0f
  3728.0f, 1893.0f, 1480.0f, 2086.0f,  419.0f, 1415.0f, 2418.0f, 2369.0f, 1298.0f, 1260.0f, 2670.0f, 2355.0f,  573.0f,  661.0f,11834.0f, 2320.0f, 3300.0f,  179.0f,  876.0f, 2179.0f, // P
  4610.0f, 2287.0f, 2304.0f, 2828.0f,  901.0f, 1595.0f, 2923.0f, 3863.0f, 1642.0f, 1558.0f, 2876.0f, 2847.0f,  743.0f,  856.0f, 2320.0f, 3611.0f, 4686.0f,  272.0f, 1188.0f, 2695.0f, // S
  6264.0f, 3487.0f, 3204.0f, 3843.0f, 1197.0f, 2323.0f, 4159.0f, 4169.0f, 2446.0f, 3131.0f, 5272.0f, 4340.0f, 1361.0f, 1498.0f, 3300.0f, 4686.0f, 8995.0f,  397.0f, 1812.0f, 5172.0f, // T
   418.0f,  444.0f,  219.0f,  204.0f,  187.0f,  219.0f,  278.0f,  375.0f,  383.0f,  417.0f, 1063.0f,  333.0f,  218.0f, 1000.0f,  179.0f,  272.0f,  397.0f, 4101.0f, 1266.0f,  499.0f, // W
  1824.0f, 1338.0f, 1148.0f, 1119.0f,  664.0f,  871.0f, 1268.0f, 1186.0f,  876.0f, 1697.0f, 3945.0f, 1451.0f,  828.0f, 4464.0f,  876.0f, 1188.0f, 1812.0f, 1266.0f, 9380.0f, 2227.0f, // Y
  5709.0f, 2356.0f, 1759.0f, 2015.0f, 1373.0f, 1682.0f, 2809.0f, 2569.0f, 1691.0f, 7504.0f,11005.0f, 2932.0f, 2310.0f, 2602.0f, 2179.0f, 2695.0f, 5172.0f,  499.0f, 2227.0f,11569.0f};// V

}  // namnespace


namespace cs {

GonnetMatrix::GonnetMatrix() {
    for (int a = 0; a < size_; ++a)
        for (int b = 0; b < size_; ++b)
            p_[a][b] = 0.000001f * g_gonnet[a * size_ + b];

    // Let base class init method do the rest.
    init_from_target_frequencies();
}

}  // namespace cs
